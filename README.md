# Thailand Domestic Tourism 2019 to 2023
## Introduction
This is a data analysis on Thailand Domestic Tourism using a dataset from **January 2019 to February 2023**. I chose to explore this data as I had recently traveled back to Thailand and were also there right before the Covid lockdown. I am curious to see the changes in Thai domestic tourism from prior to Covid outbreak to post Covid outbreak. There are four aspects in this data that will be analysed for trends and insights including total revenue, number of tourists, number of occupied hotel rooms and occupancy rate. The insights and recommendations will be based on the results of my analysis combined with my general knowledge as a Thai person.

_**Note:** Since the dataset only contains 2 months for the year 2023, the results of this analysis will not show the full picture for 2023 but it is still a great indication for what is likely to happen and a useful source for understanding the trends and changes between 2019 and 2023._

### My analytical workflow
1. Import and prepare data
2. Process and clean my data
3. Calculate and analyse my data
4. Visualise findings and provide insights and recommendations

## Import and prepare data
First, I will download this [dataset](https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics) from Kaggle and import it into MySQL to view the dataset. This dataset was sourced from raw data provided by the [Official Ministry of Tourism and Sports Statistics. ](http://www.mots.go.th/news/category/411). This dataset is from January 2019 to February 2023. 

`region_thai` and `province_thai` columns (the Thai version of the province and region columns) will be dropped as they are not required in this analysis.

![unnamed](https://github.com/ksadangrit/thailand_domestic_tourism/assets/156267785/82823d4a-d0d9-4772-ab37-c7aa2874fa1c)

### Columns in the dataset
* `province_eng` contains the english version of the name of provinces in Thailand.

* `region_eng` contains the english version of the name of regions in Thailand.

* `variable` contains *8 different types* of data being recorded. This includes the following:

  `no_tourist_all` shows the total number of domestic tourists that visited the province.
  
  `no_tourist_foreign` shows the number of foreign tourists that visited the province.

  `no_tourist_thai` shows the number of Thai tourists that visited the province.

  `no_tourist_stay` shows the total number of occupied hotel rooms in the province.

  `ratio_tourist_stay` shows the percentage of occupied travel accomodation in the province.

  `revenue_all` shows the revenue generated by the tourism industry, in Thai Baht (฿).

  `revenue_foreign` shows the revenue generated from foreign tourists in the province, in in Thai Baht (฿).

  `revenue_thai` shows the revenue generated from Thai tourists in the province, in in Thai Baht (฿).

## Process and clean my data
As the `variabel` column has 8 unique variables, tidying up data by creating new columns with different variables will make it easier for analysis and understading the dataset. I will also create an id column and another column for the country name (solely because without the country name, I have encontoured an issue in filling in color for a map while using Tableau before).

### Create a new table
First, I will craete a new table using the below query. This table contains only the column names (some original names will be changed to make it more clear) with no corresponding dataset in the table.
```
/* Create a new table */
CREATE TABLE thailand_domestic_tourism (
	id INT NOT NULL AUTO_INCREMENT,
	date DATE,
	province VARCHAR(255),
	region VARCHAR(255),
	country VARCHAR(255),
	occupancy_rate FLOAT,
	num_occupied_room FLOAT,
	num_tourist_all FLOAT,
	num_tourist_thai FLOAT,
	num_tourist_foreign FLOAT,
	revenue_all FLOAT,
	revenue_thai FLOAT,
	revenue_foreign FLOAT,
	PRIMARY KEY (id)
);
```
After creating a new table, I will insert the data for the following original columns including `date`, `province`, `region` and also the `country` and `occupancy_rate` columns that I've just created. I will not inset all the data for other variables at this stage.
```
/* Insert data */
INSERT INTO thailand_domestic_tourism (date, province, region, country, occupancy_rate)
SELECT
	STR_TO_DATE(CONVERT(date using utf8), '%Y-%m-%d'),
	TRIM(province_eng),
	TRIM(region_eng),
	"thailand",
	value
FROM
	thailand_domestic_tourism_2019_2023_ver2
WHERE
	variable = 'ratio_tourist_stay';
```
I will now insert the correspending values for each new column one by one starting with `num_occupied_room`
```
/* Fill in the rest of the columns with data */
UPDATE
	thailand_domestic_tourism AS new_table
	INNER JOIN (
		SELECT
			*
		FROM
			thailand_domestic_tourism_2019_2023_ver2
		WHERE
			variable = 'no_tourist_stay') AS original_table ON STR_TO_DATE(CONVERT(original_table. `date`
				USING utf8), '%Y-%m-%d') = new_table. `date`
		AND TRIM(original_table.province_eng) = new_table.province SET new_table.num_occupied_room = original_table.value;
```

The above query will be used to fill in the data for the rest of the columns and the only thing I need to change in this query is just the name of the column from the orignal_table and the new table I've just created.

I then check whether the name of the province has a correct corresponding region using the following query.
```
SELECT DISTINCT
	(province),
	region
FROM
	thailand_domestic_tourism;
```

As `Sisaket` is a province in the northeastern region, not the southern region, I will fix this error using the following query.
```
UPDATE thailand_domestic_tourism
SET region = 'east_northeast' WHERE province = 'Sisaket';
```

## Calculate and analyse my data
Now I will start of by comparing between the number and percentage that each type of tourists (Thai tourists and foreign tourists) contribute to the overall revenue and number of tourists from all years combines. Then I will look at the dataset through 3 different aspects: _total revenue, number of tourists_ and _number of occupied hotel rooms_(_the occupancy rate_ is also considered along side this aspect). For each aspect, I will analyse the dataset by ranking the years, months and regions and calculating the top 10 provinces.

```
/*See the big picture of all years combined */
SELECT
	SUM(revenue_foreign) AS sum_revenue_foreign,
	SUM(revenue_thai) AS sum_revenue_thai,
	SUM(revenue_all) AS total_revenue,
	CONCAT(ROUND(SUM(revenue_foreign)/SUM(revenue_all)*100),'%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(revenue_thai)/SUM(revenue_all)*100),'%') AS thai_percentage,
	SUM(num_tourist_foreign) AS total_num_foreign,
	SUM(num_tourist_thai) AS total_num_thai,
	SUM(num_tourist_all) AS total_num,
	CONCAT(ROUND(SUM(num_tourist_foreign) / SUM(num_tourist_all) * 100), '%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(num_tourist_thai) / SUM(num_tourist_all) * 100), '%') AS thai_percentage
FROM
	thailand_domestic_tourism
ORDER BY
	total_revenue DESC;  
```

### Total Revenue
#### Check for MAX, MIN and AVG of every year.
```
SELECT
	YEAR(date) AS year,
	AVG(revenue_all) AS avg_revenue,
	MAX(revenue_all) AS max_revenue,
	MIN(revenue_all) AS min_revenue
FROM
	thailand_domestic_tourism
GROUP BY
	year;
```

#### Check for total revenue for each year
```
SELECT
	YEAR(date) AS year,
	SUM(revenue_foreign) AS sum_revenue_foreign,
	SUM(revenue_thai) AS sum_revenue_thai,
	SUM(revenue_all) AS total_revenue,
	CONCAT(ROUND(SUM(revenue_foreign)/SUM(revenue_all)*100),'%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(revenue_thai)/SUM(revenue_all)*100),'%') AS thai_percentage 
FROM
	thailand_domestic_tourism
GROUP BY
	year 
ORDER BY
	total_revenue DESC;
```

#### Check for top 10 provinces with the most total revenue
```
SELECT
	province,
	region,
	SUM(revenue_foreign) AS sum_revenue_foreign,
	SUM(revenue_thai) AS sum_revenue_thai,
	SUM(revenue_all) AS total_revenue,
	CONCAT(ROUND(SUM(revenue_foreign) / SUM(revenue_all) * 100), '%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(revenue_thai) / SUM(revenue_all) * 100), '%') AS thai_percentage
FROM
	thailand_domestic_tourism
GROUP BY
	province,
	region
ORDER BY
	total_revenue DESC
LIMIT 10;      
```
#### Rank the provinces
Now I will look at top 10 provinces based on the total revenue generated from each type of tourists to find out what provinces different types of tourists spent their money in the most and whether there are any correlation between different types.

**Thai Tourist** 
```
/* For Thai: Rank top 10 province with the most total revenue from Thai tourists */ 
SELECT
	province,
	SUM(revenue_thai) AS sum_revenue_thai
FROM
	thailand_domestic_tourism
GROUP BY
	province
ORDER BY
	sum_revenue_thai DESC
LIMIT 10;
```
**Foreign tourists**
```
/* For Foreigners: Rank top 10 province with the most total revenue from Foreign tourists */ 
SELECT
	province,
	SUM(revenue_foreign) AS sum_revenue_foreign
FROM
	thailand_domestic_tourism
GROUP BY
	province
ORDER BY
	sum_revenue_foreign DESC
LIMIT 10;
```

#### Rank the regions
#### Rank all regions based on total revenue
```
SELECT
	region,
	SUM(revenue_foreign) AS sum_revenue_foreign,
	SUM(revenue_thai) AS sum_revenue_thai,
	SUM(revenue_all) AS total_revenue,
	CONCAT(ROUND(SUM(revenue_foreign) / SUM(revenue_all) * 100), '%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(revenue_thai) / SUM(revenue_all) * 100), '%') AS thai_percentage
FROM
	thailand_domestic_tourism
GROUP BY
	region
ORDER BY
	total_revenue DESC;
```

Now I will rank all the regions based on the total revenue generated from each type of tourists to find out if there is any correlation or differences between the rank of provinces and regions for different types of tourists.

**Thai tourists**
```
SELECT
	region,
	SUM(revenue_thai) AS sum_revenue_thai
FROM
	thailand_domestic_tourism
GROUP BY
	region
ORDER BY
	sum_revenue_thai DESC;
```

**Foreign tourists**
```
SELECT
	region,
	SUM(revenue_foreign) AS sum_revenue_foreign
FROM
	thailand_domestic_tourism
GROUP BY
	region
ORDER BY
	sum_revenue_foreign DESC;  
```
# Rank the months
Now I will rank the months based on the total revenue to see if there are any trends throughout a year
```
SELECT
	MONTHNAME(date) AS month,
	SUM(revenue_foreign) AS sum_revenue_foreign,
	SUM(revenue_thai) AS sum_revenue_thai,
	SUM(revenue_all) AS total_revenue,
	CONCAT(ROUND(SUM(revenue_foreign)/SUM(revenue_all)*100),'%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(revenue_thai)/SUM(revenue_all)*100),'%') AS thai_percentage 
FROM
	thailand_domestic_tourism
GROUP BY
	month
ORDER BY
	total_revenue DESC;  
```

**For Thai tourists**
```
/* For Thai: Check total revenue from Thai tourists based on months */
SELECT
	MONTHNAME(date) AS month,
	SUM(revenue_thai) AS sum_revenue_thai
FROM
	thailand_domestic_tourism
GROUP BY
	month
ORDER BY
	sum_revenue_thai DESC;
```

**For foreign tourists**
```
SELECT
	MONTHNAME(date) AS month,
	SUM(revenue_foreign) AS sum_revenue_foreign
FROM
	thailand_domestic_tourism
GROUP BY
	month
ORDER BY
	sum_revenue_foreign DESC;
```

### Number of tourists
As I have already calculated and compared the the total number of Thai and foreign tourists at the begining of the analysis stage, I will now rank the years based on the total number of tourists, I will also look at the number and percentage that each tourist types contributes.
```
/* Rank years based on total number of tourists */
SELECT
	YEAR(date) AS year,
	SUM(num_tourist_foreign) AS total_num_foreign,
	SUM(num_tourist_thai) AS total_num_thai,
	SUM(num_tourist_all) AS total_num,
	CONCAT(ROUND(SUM(num_tourist_foreign) / SUM(num_tourist_all) * 100), '%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(num_tourist_thai) / SUM(num_tourist_all) * 100), '%') AS thai_percentage
FROM
	thailand_domestic_tourism
GROUP BY
	year
ORDER BY
	total_num DESC; 
```

#### Top 10 most visited provinces
Now I will look at top 10 provinces based on the total number of tourists to find out what the top 10 most visisted provinces are among all tourists. 
```
/* Rank provinces by total number of tourists */
SELECT
	province,
	region,
	SUM(num_tourist_foreign) AS total_num_foreign,
	SUM(num_tourist_thai) AS total_num_thai,
	SUM(num_tourist_all) AS total_num,
	CONCAT(ROUND(SUM(num_tourist_foreign) / SUM(num_tourist_all) * 100), '%') AS foreigner_percentage,
	CONCAT(ROUND(SUM(num_tourist_thai) / SUM(num_tourist_all) * 100), '%') AS thai_percentage
FROM
	thailand_domestic_tourism
GROUP BY
	province,
	region 
ORDER BY 
	total_num DESC LIMIT 10;  
```

For Thai
